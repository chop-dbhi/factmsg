# 0.1.0

## Fields

Field | Type | Description | Constraints | Semantics
------|------|-------------|-------------|----------
`spec` | `string` | The [semantic version](http://semver.org/) of the specification. | This must be a valid spec version. | -
`domain` | `string` | The domain or namespace of the value's identity. | Allowed characters `[A-Z][a-z][0-9]-._` |  See [identity](#identity)
`name` | `string` | The name of the value's identity. | Requires `domain` to be set. Allowed characters `[A-Z][a-z][0-9]-._` |  See [identity](#identity)
`version` | `string` | Defines the semantic version of the identity this value is associated with. | Requires a valid SemVer version string. | See [versioning](#versioning)
`revision` | `string` | Uniquely identifies the value for the [identity](#identity). | - | See [versioning](#versioning)
`time` | `uint64` | A Unix epoch timestamp in nanoseconds when the message was produced. | - | -
`value` | `<T>` | The value of the message. | The opaque value of the message. | -
`refs` | `map[string]map[string]<T>` | A set of references to other entities. | At minimum, each `ref` must define the `name` field which is the identity being referenced. Any of the additional may be included with the exception of `refs`. | See [references](#references)
`meta` | `map[string]<T>` | A set of metadata to annotate the entity. | - | See [metadata](#metadata)
`labels` | `array[string]` | A set of strings that annotate the message. | Allowed characters `[A-Z][a-z][0-9]-._` | See [labels](#labels)

## Types

The set of types encoder implementations are expected to support.

Type | Description
-----| -----------
`byte` | A byte.
`bool` | A boolean.
`int32` | Signed 32-bit integer.
`int64` | Signed 64-bit integer.
`uint32` |  Unsigned 32-bit integer.
`uint64` | Unsigned 64-bit integer.
`float32` | 32-bit floating point.
`float64` | 64-bit floating point.
`time` | An [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) formatted string.
`string` | Variable-length UTF-8 encoded string.
`array[<T>]` | Array of values of type `T`.
`map[<T>]<T'>` | Map of key-value pairs with keys of type `T` and values of type `T'`.

## Semantics

### Identity

An identity identifies a persistent thing (e.g. an object) that changes state over time. It is composed of the `domain` and `name` fields where the `domain` acts as a namespace for a set of related identities and the `name` is unique in that domain. A value may or may not have an identity. The rule of thumb is that if a value describes a volatile state of a persistent object, then this value should have an identity. Also, if the value itself needs to be "looked up" in a downstream system, then it too should have an identity.

For example, events or actions are values that typically do not require an identity since they are rarely consumed or evaluated invidually, but rather in aggregate. However, objects and other entities would have an identity since their state generally changes over time

From a tooling standpoint, messages can be consumed

### Versioning

The `version` and `revision` fields may be used to add explicit version information to the value if it available. The `revision` field uniquely identifies the value relative to the [identity](#identity). For example, the [commit SHA-1](https://git-scm.com/book/en/v2/Git-Tools-Revision-Selection#Single-Revisions) is a revision string that uniquely identifies the state of a Git repository.

From a consumer standpoint, if a message is seen with the same identity and revision that was previously seen, the message may be dropped. If the message is consumed anyway, the value is assumed to be the same.

The `version` field may be used if a higher-level [semantic version](http://semver.org) of the identity is known. Using analogy to Git, a `version` would correspond to the pending [tagged release](https://git-scm.com/book/en/v2/Git-Basics-Tagging) such as `1.3.4`. This ties together sets of values that were associated to a particular version.

### References

It is common for values to have references to other values, either locally (in the same domain) or remotely (external domain). The `refs` object defines a set of named references to other values identitied by the `domain` and `name` fields. In addition, the [version fields](#versioning) may be supplied to specify the version of the value being referenced. This may be useful if the current value depends on an older version of the referenced value. If the version information is not set, the `time` field implicitly denotes when the reference was known to be valid.

### Metadata

The `meta` field is a set of key-value pairs that may contain additional domain-specific information.

### Labels

A set of `labels` may be supplied to classify the value. In general these should be short and simple. Consumers should treat labels as unique to the particular domain the value is defined in.
